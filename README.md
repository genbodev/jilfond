# jilfond

### Работа с лентой RSS
Код написан на чистом JS + PHP + HTML без ипользования сторонних плагинов

Все запросы к серверу происходят посредством ajax

При начальной загрузке происходит отправка запроса методом GET с заголовком urlencoded

ajax.php проверяет параметры GET запроса и, если все в порядке - обращается к ресурсу за лентой RSS

В примере задействовано кеширование через Memcache, поэтому, прежде чем запросить ленту - проверяется кеш.

Если необходимый массив имеется в кеше - происходит дополнение массива комментариями из БД

Если массива нет - вот тогда идет обращение к ленте с ее разбором через simplexml_load_file, а уже затем - дополнение комментариями

Каждой новости соответствует свой guid в структуре xml.

Через хеширование (md5) guid проверяется наличие комментариев к подгруженным новостям (items ленты)

Приведен пример работы с mysqli. Был отброшен вариант с запросом в цикле, взамен используется пример сотавления одного запроса.

Для этого используется bind_param в совокупности с call_user_func_array, а необходимые данные для запроса собираются во время прохода по каждому item xml

script.js содержит код, который предоставляет возможность оставить комментарий.

Форма для комментария появляется при клике на соответсвующий объект DOM

Форма содержит поля для email и, непосредственно, самого комментария.

Имеется пример работы с объектом FormData

Данные этого объекта также уходят на сервер посредством ajax

ajax.php каждый раз проверяет наличие параметра для загрузки ленты, если параметра нет - имеем дело с комментарием.

Комментарий сохраняется в БД, дата создания возвращается в js, js генерирует для DOM новые элементы с информацией по комментарию.

